# SiglusEngine-research

## SiglusEngine åˆæ­¥èªè­˜

### æ¶æ§‹

![01](img/01.png)

ğŸ”¼ ä»¥å¤©ç±Ÿäººå¶ç‚ºä¾‹
___

### Tree

```plaintext
.
â”œâ”€â”€ bgm
â”‚   â”œâ”€â”€ BGM001.nwa
â”‚   â””â”€â”€ ...
â”œâ”€â”€ dat
â”‚   â”œâ”€â”€ NotoSerifJP-Black.otf
â”‚   â””â”€â”€ ...
â”œâ”€â”€ g00
â”‚   â”œâ”€â”€ __sys_cf_msfilter00.g00
â”‚   â””â”€â”€ ...
â”œâ”€â”€ gan
â”‚   â”œâ”€â”€ ef_em21.gan
â”‚   â””â”€â”€ ...
â”œâ”€â”€ koe
â”‚   â”œâ”€â”€ z0301.ovk
â”‚   â””â”€â”€ ...
â”œâ”€â”€ mov
â”‚   â”œâ”€â”€ ED01.omv
â”‚   â””â”€â”€ ...
â”œâ”€â”€ savedata
â”‚   â”œâ”€â”€ config.sav
â”‚   â”œâ”€â”€ system.ini
â”‚   â”œâ”€â”€ window.ini
â”‚   â””â”€â”€ ...
â”œâ”€â”€ wav
â”‚   â”œâ”€â”€ ARM_TOUCH1.nwa
â”‚   â””â”€â”€ ...
â”œâ”€â”€ Gameexe.dat
â”œâ”€â”€ Mai@KF.dll
â”œâ”€â”€ primadoll01.ico
â”œâ”€â”€ Scene.pck
â”œâ”€â”€ SiglusEngine.exe
â”œâ”€â”€ SiglusEngine.exe.org
â””â”€â”€ SiglusEngine.log
```

éŠæˆ²ç›®éŒ„çš„æ¨¹ç‹€åœ–é•·é€™æ¨£ï¼ŒåŸºæœ¬ä¸Šé™¤äº†æœ‰äº›å¾®æª”æ¡ˆæœ‰å·®ç•°å¤–ï¼Œæœ€ä¸»è¦å°±æ˜¯ __Gameexe.dat__, __SiglusEngine.exe__, __Scene.pck__ï¼Œæœ‰é€™ä¸‰å€‹æª”æ¡ˆåŸºæœ¬ä¸Šä¸€å®šæ˜¯SiglusEngine

## å·¥å…·ä»‹ç´¹

* [SiglusExtract](https://github.com/xmoezzz/SiglusExtract)
ä¸€å€‹å°ˆé–€ç”¨ä¾†æå–Sigluså¼•æ“è³‡æºçš„å·¥å…·ï¼ŒåŸºæœ¬ä¸Šæ‹†åŒ…æ“ä½œéƒ½æœƒä½¿ç”¨é€™å€‹è»Ÿé«”é€²è¡Œï¼Œä¸éè©²è»Ÿé«”å·²ç¶“å››å¹´æ²’æ›´æ–°ï¼ŒæœŸæœ›å¾€å¾Œæœ‰æ–°çš„å°ˆå®¶å‡ºä¾†ç¶­è­·è©²å°ˆæ¡ˆã€‚

___

__å› ç‚ºå¤©ç±Ÿäººå¶æ‹†åŒ…æœ‰é»å•é¡Œæ‰€ä»¥æ›æˆ _èŠ±å’²workspringï¼_ ä¾†æ¸¬è©¦__

## Scene.pck

### æ‹†åŒ…

![02](img/02.png)

å°‡ä¸‹è¼‰çš„å…©å€‹æª”æ¡ˆä¸Ÿé€²éŠæˆ²ç›®éŒ„ä¸¦æŠŠ __SiglusEngine.exe__ æ‹–æ›³åˆ° __SiglusExtract.exe__ ä¸Š:

![03](img/03.png)

å†å°‡ __Scene.pck__ ç›´æ¥æ‹–æ›³åˆ° __SiglusEngine.exe__ ä»‹é¢ä¸Šå°±å¯ä»¥äº†
æœƒå¾—åˆ°ä¸€å€‹ __\_\_Unpack\_\___ è³‡æ–™å¤¾ï¼Œè£¡é¢æœƒæœ‰ __Scene__ å­˜æ”¾æ‰€æœ‰æ–‡æœ¬æª”æ¡ˆï¼Œä¸»è¦é—œæ³¨å‰¯æª”åç‚º __.ss__ çš„æª”æ¡ˆ

ä¿®æ”¹æ–‡æœ¬æœƒéœ€è¦[ScriptRepacker](https://github.com/xmoezzz/SiglusExtract/blob/master/tools/ScriptRepacker.exe)é€™å€‹å·¥å…·ï¼Œä¸‹è¼‰å¾Œèˆ‡æƒ³æ”¹çš„æ–‡ä»¶( __.ss.txt__ ä»¥åŠ __.ss__)ç§»å‹•åˆ°åŒä¸€å€‹ç›®éŒ„

![04](img/04.png)

æ›´æ”¹ __.ss.txt__ çš„æ–‡æª”

![05](img/05.png)

ä¿®æ”¹å®Œå¾Œå°‡å…©å€‹æª”æ¡ˆæ‹–æ›³åˆ° __ScriptRepacker.exe__ ä¸Šï¼Œ__æˆåŠŸæœƒç”Ÿæˆ.ss.outæ–‡ä»¶__

å°‡åŸæœ¬çš„.ssæ–‡ä»¶åˆªé™¤ï¼Œå°‡ __.ss.out__ æ–‡ä»¶å¾Œçš„ __.out__ å»é™¤ï¼Œèˆ‡ __.ss.txt__ å…©å€‹æª”æ¡ˆè¦†è“‹å›åŸæœ¬è³‡æ–™å¤¾è£¡

![06](img/06.png)

### å°åŒ…

åœ¨ __SiglusEngine.exe__ çš„ä»‹é¢ä¸­çš„Repack Scene.pckä¸Šé¸é¸æ“‡å‰›å‰›å°å‡ºä¾† __Scene__ è³‡æ–™å¤¾ï¼ŒæŒ‰ __Do pack!__ ç­‰åˆ°ä»–è·‘å¥½å°±å¯ä»¥äº†

![07](img/07.png)

ä¹‹å¾Œå°‡ç”¢ç”Ÿå‡ºä¾†çš„ __Scene.pck.new__ æ”¹åç‚º __Scene.pck2__

é»æ“Šå³ä¸‹è§’çš„ __Make UniversalPatch__ ç”Ÿæˆå•Ÿå‹•æ–‡ä»¶ï¼Œæœƒç”Ÿæˆ __SiglusUniversalPatch.dll__ ä»¥åŠ __SiglusEngine_Patch.exe__ï¼Œé»æ“Š __SiglusEngine_Patch.exe__ å•Ÿå‹•éŠæˆ²å°±å¯ä»¥äº†

![08](img/08.png)